<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Predict GRN from scRNA+scATAC data (Chen 2018 dataset) • HuMMuS</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Predict GRN from scRNA+scATAC data (Chen 2018 dataset)">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-36XYS9J0B3"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-36XYS9J0B3');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HuMMuS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/add_networks.html">Add external networks to HuMMuS object</a></li>
    <li><a class="dropdown-item" href="../articles/chen_vignette.html">Predict GRN from scRNA+scATAC data (Chen 2018 dataset)</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cantinilab/HuMMuS"><span class="fa fab fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://research.pasteur.fr/en/team/machine-learning-for-integrative-genomics/"><span class="fa fas fa-university"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Predict GRN from scRNA+scATAC data (Chen 2018 dataset)</h1>
                        <h4 data-toc-skip class="author">Trimbour
Rémi</h4>
            
            <h4 data-toc-skip class="date">2023-05-16</h4>
      

      <div class="d-none name"><code>chen_vignette.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="useful-links">Useful links:<a class="anchor" aria-label="anchor" href="#useful-links"></a>
</h3>
<p><em>Paper</em>: <a href="https://www.biorxiv.org/content/10.1101/2023.06.09.543828v1" class="external-link uri">https://www.biorxiv.org/content/10.1101/2023.06.09.543828v1</a></p>
<p><em>Github repo</em>: <a href="https://github.com/cantinilab/HuMMuS" class="external-link uri">https://github.com/cantinilab/HuMMuS</a></p>
<p><em>Documentation</em>: <a href="https://cantinilab.github.io/HuMMuS/" class="uri">https://cantinilab.github.io/HuMMuS/</a></p>
</div>
<div class="section level2">
<h2 id="general-description-of-the-pipeline">General description of the pipeline<a class="anchor" aria-label="anchor" href="#general-description-of-the-pipeline"></a>
</h2>
<div class="float">
<img src="figures/schema_HuMMuS.png" alt="Overall pipeline"><div class="figcaption">Overall pipeline</div>
</div>
<div class="section level3">
<h3 id="useful-ressources">Useful ressources<a class="anchor" aria-label="anchor" href="#useful-ressources"></a>
</h3>
<p><em>Preprint detailing the method:</em> <a href="https://www.biorxiv.org/content/10.1101/2023.06.09.543828v1" class="external-link">https://www.biorxiv.org/content/10.1101/2023.06.09.543828v1</a></p>
<p><em>Github repo detailing the installation:</em> <a href="https://github.com/cantinilab/HuMMuS/tree/" class="external-link">https://github.com/cantinilab/HuMMuS</a></p>
<p><em>Documentation and vignette:</em> <a href="https://cantinilab.github.io/HuMMuS">https://cantinilab.github.io/HuMMuS</a></p>
<div class="section level4">
<h4 id="general-plan">General plan<a class="anchor" aria-label="anchor" href="#general-plan"></a>
</h4>
<div class="section level6">
<h6 id="preparation-of-the-environment">0. Preparation of the environment<a class="anchor" aria-label="anchor" href="#preparation-of-the-environment"></a>
</h6>
</div>
<div class="section level6">
<h6 id="initialisation-of-a-hummus-object">1. Initialisation of a hummus object<a class="anchor" aria-label="anchor" href="#initialisation-of-a-hummus-object"></a>
</h6>
</div>
<div class="section level6">
<h6 id="construction-of-the-multilayer">2. Construction of the multilayer<a class="anchor" aria-label="anchor" href="#construction-of-the-multilayer"></a>
</h6>
</div>
<div class="section level6">
<h6 id="analyse-multilayer-and-define-gene-regulatory-network-grn">3. Analyse multilayer and define gene regulatory network (GRN)<a class="anchor" aria-label="anchor" href="#analyse-multilayer-and-define-gene-regulatory-network-grn"></a>
</h6>
</div>
</div>
</div>
<div class="section level3">
<h3 id="setting-up-the-environment">0. Setting up the environment<a class="anchor" aria-label="anchor" href="#setting-up-the-environment"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install python dependency</span></span>
<span><span class="va">envname</span> <span class="op">=</span> <span class="st">"r-reticulate"</span></span>
<span><span class="co"># reticulate::py_install("hummuspy", envname = envname, pip=TRUE)</span></span>
<span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/use_python.html" class="external-link">use_condaenv</a></span><span class="op">(</span><span class="va">envname</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hummuspy</span> <span class="op">&lt;-</span> <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/import.html" class="external-link">import</a></span><span class="op">(</span><span class="st">"hummuspy"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cantinilab.github.io/HuMMuS/">HuMMuS</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
</div>
<div class="section level3">
<h3 id="download-the-single-cell-data">Download the single-cell data<a class="anchor" aria-label="anchor" href="#download-the-single-cell-data"></a>
</h3>
<p>The data used in this tutorial can be <a href="https://figshare.com/account/home#/projects/168899" class="external-link">downloaded
here</a></p>
</div>
<div class="section level3">
<h3 id="initialisation-of-hummus-object">1. Initialisation of HuMMuS object<a class="anchor" aria-label="anchor" href="#initialisation-of-hummus-object"></a>
</h3>
<p>HuMMuS R objects are instances developed on top of seurat objects. It
means it’s created from a seurat object and the contained assays can be
accessed the same way.</p>
<p>Additionally, it contains a motifs_db object, providing tf motifs
informations, and a multilayer objects, that will be completed while
going through this tutorial. It will mostly include :</p>
<ul>
<li>list of multiplex networks (one per modality)</li>
<li>list of bipartites (one per connection between layers) <img src="figures/hummus_object_description.png" alt="hummus object schema">
</li>
</ul>
<div class="section level4">
<h4 id="transform-data-into-a-hummus-object">1.1. Transform data into a hummus object<a class="anchor" aria-label="anchor" href="#transform-data-into-a-hummus-object"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the Chen dataset, which is a Seurat object containing scRNA-seq and scATAC-seq data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"chen_dataset_subset"</span><span class="op">)</span></span>
<span><span class="va">chen_dataset_subset</span></span></code></pre></div>
<pre><code><span><span class="co">## An object of class Seurat </span></span>
<span><span class="co">## 12000 features across 385 samples within 2 assays </span></span>
<span><span class="co">## Active assay: RNA (2000 features, 0 variable features)</span></span>
<span><span class="co">##  2 layers present: counts, data</span></span>
<span><span class="co">##  1 other assay present: peaks</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create an hummus object from seurat object</span></span>
<span><span class="va">hummus</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Initiate_Hummus_Object.html">Initiate_Hummus_Object</a></span><span class="op">(</span><span class="va">chen_dataset_subset</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="add-genome-and-motif-annotations-to-hummus-object">1.2. Add genome and motif annotations to hummus object<a class="anchor" aria-label="anchor" href="#add-genome-and-motif-annotations-to-hummus-object"></a>
</h4>
<p>Fetch genome annotations online (necessitate an internet connection).
You can also request any “EnsDB” object adapted to your data
(e.g. EnsDb.Hsapiens.v86::EnsDb.Hsapiens.v86 for human genome
annotations) or use your own genome annotations in the same format.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get human genome annotation from EndDb data</span></span>
<span><span class="co"># wrapper of Signac::GetGRangesFromEnsDb, adapting output to UCSC format</span></span>
<span><span class="va">genome_annotations</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_genome_annotations.html">get_genome_annotations</a></span><span class="op">(</span></span>
<span>  ensdb_annotations <span class="op">=</span> <span class="fu">EnsDb.Hsapiens.v86</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/EnsDb.Hsapiens.v86/man/package.html" class="external-link">EnsDb.Hsapiens.v86</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># can also be downloaded, saved as an RDS objects for example</span></span></code></pre></div>
<p>Add genome annotations to hummus/seurat object</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Signac</span><span class="fu">::</span><span class="fu"><a href="https://stuartlab.org/signac/reference/Annotation.html" class="external-link">Annotation</a></span><span class="op">(</span><span class="va">hummus</span><span class="op">@</span><span class="va">assays</span><span class="op">$</span><span class="va">peaks</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">genome_annotations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">genome_annotations</span><span class="op">)</span></span></code></pre></div>
<p>Get TF motifs from JASPAR2020 and chromVARmotifs databsases in a
motifs_db object. By default, human motifs are used. You can specify the
species you want to use with the <code>species</code> argument
(e.g. species = “mouse” for mouse). motifs_db objects contain 3 slots :
* <code>motifs = "PWMatrixList"</code> *
<code>tf2motifs = "data.frame"</code> * <code>tfs = "NULL"</code>
PWMatrixList is a named vector of the motif matrices, whil tf2motifs is
a correspondance table between TFs and motifs. tfs is a named vector of
the TFs. You can also use your own motifs_db object, as long as it
contains the same slots.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load TF motifs from JASPAR2020 and chromVARmotifs in hummus object</span></span>
<span><span class="va">hummus</span><span class="op">@</span><span class="va">motifs_db</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_tf2motifs.html">get_tf2motifs</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># by default human motifs</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="construction-of-the-multilayer-1">2. Construction of the multilayer<a class="anchor" aria-label="anchor" href="#construction-of-the-multilayer-1"></a>
</h3>
<div class="float">
<img src="figures/build_multilayer.png" alt="hummus object schema"><div class="figcaption">hummus object schema</div>
</div>
<p>You can compute the different layers and bipartites as indicated
below.</p>
<p>An example multilayer completed can also be imported with :
<code>data(chen_subset_hummus)</code>. This object corresponds to a
multilayer from chen_dataset_subset completed. You can then go to the
part 3, replacing <code>hummus</code> by <code>chen_subset_hummus</code>
in each step.</p>
<p>Finally, <a href="add_networks.Rmd">you can compute the different
layers before, and add them afterwards</a>. It allows to use faster
methods to compute the networks (e.g. <a href="https://arboreto.readthedocs.io/en/latest/" class="external-link">Arboreto</a> for the
gene network, <a href="https://github.com/r-trimbour/ATACNet" class="external-link">ATACNet</a> for the peak
network, etc.).</p>
<div class="section level4">
<h4 id="compute-3-layers-and-2-bipartites">Compute 3 layers and 2 bipartites<a class="anchor" aria-label="anchor" href="#compute-3-layers-and-2-bipartites"></a>
</h4>
<div class="float">
<img src="figures/5_steps.png" alt="hummus object schema"><div class="figcaption">hummus object schema</div>
</div>
<p><strong>!! Long step !!</strong> You can also go directly to the part
3 for your “discovery tour”. :)</p>
</div>
<div class="section level4">
<h4 id="tf---peaks-bipartite-reconstruction">2.1. TF - peaks bipartite reconstruction<a class="anchor" aria-label="anchor" href="#tf---peaks-bipartite-reconstruction"></a>
</h4>
<p>TF - peaks bipartite is computed using the motifs_db object and the
peak assay. You can specify the assay to use to filter TFs (e.g. “RNA”
if you want to use only the TFs expressed in your dataset). If NULL, all
TFs with motifs will be used. BSGenome object is used to identify
location of motifs and intersect them with peak <br>You can also specify
the name of the bipartite that will be added to the hummus object. By
default, it will be named “tf_peak”.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hummus</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bipartite_tfs2peaks.html">bipartite_tfs2peaks</a></span><span class="op">(</span></span>
<span>              hummus_object <span class="op">=</span> <span class="va">hummus</span>,</span>
<span>              tf_expr_assay <span class="op">=</span> <span class="st">"RNA"</span>, <span class="co"># use to filter TF on only expressed TFs,</span></span>
<span>                                     <span class="co"># if NULL, all TFs with motifs are used</span></span>
<span>              peak_assay <span class="op">=</span> <span class="st">"peaks"</span>,</span>
<span>              tf_multiplex_name <span class="op">=</span> <span class="st">"TF"</span>,</span>
<span>              genome <span class="op">=</span> <span class="fu">BSgenome.Hsapiens.UCSC.hg38</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/BSgenome.Hsapiens.UCSC.hg38/man/package.html" class="external-link">BSgenome.Hsapiens.UCSC.hg38</a></span>,</span>
<span>              <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Computing TF-peak bipartite</span></span>
<span><span class="co">##   31 TFs expressed</span></span></code></pre>
<pre><code><span><span class="co">## Building motif matrix</span></span></code></pre>
<pre><code><span><span class="co">## Finding motif positions</span></span></code></pre>
<pre><code><span><span class="co">## Creating Motif object</span></span></code></pre>
<pre><code><span><span class="co">## Warning in CreateMotifObject(data = motif.matrix, positions = motif.positions,</span></span>
<span><span class="co">## : Non-unique motif names supplied, making unique</span></span></code></pre>
<pre><code><span><span class="co">##  Adding TF info</span></span>
<span><span class="co">##  Returning TF-peak links as bipartite object</span></span>
<span><span class="co">## no peak layer name provided, using peak_assay name</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="genes---peaks-bipartite-reconstruction">2.2. Genes - peaks bipartite reconstruction<a class="anchor" aria-label="anchor" href="#genes---peaks-bipartite-reconstruction"></a>
</h4>
<p>Peaks - genes bipartite is computed</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hummus</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bipartite_peaks2genes.html">bipartite_peaks2genes</a></span><span class="op">(</span></span>
<span>                      hummus_object <span class="op">=</span> <span class="va">hummus</span>,</span>
<span>                      gene_assay <span class="op">=</span> <span class="st">"RNA"</span>,</span>
<span>                      peak_assay <span class="op">=</span> <span class="st">"peaks"</span>,</span>
<span>                      store_network <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                      <span class="op">)</span></span></code></pre></div>
<div class="section level5">
<h5 id="compute-layer-networks-and-add-it-to-hummus-object">Compute layer networks and add it to hummus object<a class="anchor" aria-label="anchor" href="#compute-layer-networks-and-add-it-to-hummus-object"></a>
</h5>
<p>Each one of the three layers is computed individually.</p>
</div>
</div>
<div class="section level4">
<h4 id="compute-the-tf-network-from-omnipath-database">2.3. Compute the TF network from OmniPath database<a class="anchor" aria-label="anchor" href="#compute-the-tf-network-from-omnipath-database"></a>
</h4>
<p>We currently use OmniPath R package to fetch TF interactions. You can
first specify if you want to use only the TFs expressed in your dataset
(if you have a RNA assay in your hummus object). If
<code>gene_assay</code> is NULL, all TFs with motifs will be used. <br>
You can then specify which interactions you want to keep through
‘source_target’ argument (“AND” | “OR”). If “AND”, only the interactions
between 2 TFs that are both present in the dataset will be kept. If
“OR”, all interactions involving at least one TF present in the dataset
will be kept. <br>Finally, you can specify the name of the multiplex and
the name of the network that will be added to the hummus object. The
added network will be undirected and unweighted since PPI and OmniPath
database are not directional nor return any weight here.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hummus</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_tf_network.html">compute_tf_network</a></span><span class="op">(</span><span class="va">hummus</span>,</span>
<span>                            gene_assay <span class="op">=</span> <span class="st">"RNA"</span>, <span class="co"># default = None ;</span></span>
<span>                                                <span class="co"># If a assay is provided,</span></span>
<span>                                                <span class="co"># only the TFs that are present</span></span>
<span>                                                <span class="co"># will be considered</span></span>
<span>                            verbose <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                            <span class="co">#source_target = "OR",</span></span>
<span>                            multiplex_name <span class="op">=</span> <span class="st">"TF"</span>,</span>
<span>                            tf_network_name <span class="op">=</span> <span class="st">"TF_network"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Creating a fake TF network with all TFs connected to a fake node.</span></span>
<span><span class="co">##   31 TFs expressed</span></span>
<span><span class="co">## TF network construction time: 0.006991863    Creating new multiplex :  TF</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="compute-gene-network-from-scrna-seq-w-genie3">2.4. Compute gene network from scRNA-seq w/ GENIE3<a class="anchor" aria-label="anchor" href="#compute-gene-network-from-scrna-seq-w-genie3"></a>
</h4>
</div>
<div class="section level4">
<h4 id="this-step-can-be-very-slow-if-you-have-thousands-of-cells">
<em>!! This step can be very slow if you have thousands of cells
!!</em><a class="anchor" aria-label="anchor" href="#this-step-can-be-very-slow-if-you-have-thousands-of-cells"></a>
</h4>
<p><em>Current recommendation if you have a big dataset is to compute
the network</em> <em>before with <a href="https://arboreto.readthedocs.io/en/latest/" class="external-link">GRNBoost2 thorugh
arboreto</a></em> <em>and <a href="https://cantinilab.github.io/HuMMuS/articles/add_networks.html">add
it to the hummus object afterwards</a>.</em> Different methods can be
used to compute the gene network. For now, only GENIE3 is implemented in
HuMMuS. You can specify which assay to use to compute the network
(<code>gene_assay</code>). <br>You can specify the number of cores to
use to compute the network. You can also specify if you want to save the
network locally (<code>store_network = TRUE</code>) or not
(<code>store_network = FALSE</code>). If you choose to save the network,
you will need to specify the output file name
(<code>output_file</code>). The returned network will be considered
undirected and weighted. While GENIE3 returns a directed network, we
symmetrize it for the random walk with restart exploration of the genes
proximity.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hummus</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_gene_network.html">compute_gene_network</a></span><span class="op">(</span></span>
<span>              <span class="va">hummus</span>,</span>
<span>              gene_assay <span class="op">=</span> <span class="st">"RNA"</span>,</span>
<span>              method <span class="op">=</span> <span class="st">"GENIE3"</span>,</span>
<span>              verbose <span class="op">=</span> <span class="fl">1</span>,</span>
<span>              number_cores <span class="op">=</span> <span class="fl">5</span>, <span class="co"># GENIE3 method can be ran</span></span>
<span>                                <span class="co"># parallelised on multiple cores</span></span>
<span>              store_network <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># by default : FALSE, but</span></span>
<span>                                     <span class="co"># each network can be saved </span></span>
<span>                                     <span class="co"># when computed with hummus</span></span>
<span>              output_file <span class="op">=</span> <span class="st">"gene_network.tsv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Computing gene network with  GENIE3  ...</span></span>
<span><span class="co">##  No TFs list provided, fetching from hummus object...</span></span>
<span><span class="co">##   31 TFs expressed</span></span>
<span><span class="co">##  Gene network construction time: 7.58693 </span></span>
<span><span class="co">##  Creating new multiplex :  RNA</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="compute-the-peak-network-from-scatac-seq-w-cicero">2.5. Compute the peak network from scATAC-seq w/ Cicero<a class="anchor" aria-label="anchor" href="#compute-the-peak-network-from-scatac-seq-w-cicero"></a>
</h4>
<p>Different methods can be used to compute the peak network. For now,
only Cicero is implemented in HuMMuS. You can specify which assay to use
to compute the network (<code>peak_assay</code>). You can also specify
the number of cores to use to compute the network. You can also specify
if you want to save the network locally
(<code>store_network = TRUE</code>) or not
(<code>store_network = FALSE</code>). If you choose to save the network,
you will need to specify the output file name
(<code>output_file</code>). The returned network will be considered
undirected and weighted, since cis-regulatory interaction and Cicero
outputs are not directional.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hummus</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_atac_peak_network.html">compute_atac_peak_network</a></span><span class="op">(</span><span class="va">hummus</span>,</span>
<span>              atac_assay <span class="op">=</span> <span class="st">"peaks"</span>,</span>
<span>              verbose <span class="op">=</span> <span class="fl">1</span>,</span>
<span>              genome <span class="op">=</span> <span class="fu">BSgenome.Hsapiens.UCSC.hg38</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/BSgenome.Hsapiens.UCSC.hg38/man/package.html" class="external-link">BSgenome.Hsapiens.UCSC.hg38</a></span>,</span>
<span>              store_network <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  </span></code></pre></div>
<pre><code><span><span class="co">## Overlap QC metrics:</span></span>
<span><span class="co">## Cells per bin: 50</span></span>
<span><span class="co">## Maximum shared cells bin-bin: 44</span></span>
<span><span class="co">## Mean shared cells bin-bin: 6.39503105590062</span></span>
<span><span class="co">## Median shared cells bin-bin: 0</span></span></code></pre>
<pre><code><span><span class="co">## Warning in cicero::make_cicero_cds(input_cds, reduced_coordinates =</span></span>
<span><span class="co">## umap_coords, : On average, more than 10% of cells are shared between paired</span></span>
<span><span class="co">## bins.</span></span></code></pre>
<pre><code><span><span class="co">## [1] "Starting Cicero"</span></span>
<span><span class="co">## [1] "Calculating distance_parameter value"</span></span></code></pre>
<pre><code><span><span class="co">## Warning in estimate_distance_parameter(cds, window = window, maxit = 100, :</span></span>
<span><span class="co">## Could not calculate sample_num distance_parameters (74 were calculated) - see</span></span>
<span><span class="co">## documentation details</span></span></code></pre>
<pre><code><span><span class="co">## [1] "Running models"</span></span>
<span><span class="co">## [1] "Assembling connections"</span></span>
<span><span class="co">## [1] "Successful cicero models:  4782"</span></span>
<span><span class="co">## [1] "Other models: "</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Zero or one element in range </span></span>
<span><span class="co">##                         8803 </span></span>
<span><span class="co">## [1] "Models with errors:  0"</span></span>
<span><span class="co">## [1] "Done"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  4793 peak edges with a coaccess score &gt; 0 were found.</span></span>
<span><span class="co">## Peak network construction time: 28.01253 Creating new multiplex :  peaks</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="analyse-of-the-multilayer-and-definition-of-grn">3. Analyse of the multilayer and definition of GRN<a class="anchor" aria-label="anchor" href="#analyse-of-the-multilayer-and-definition-of-grn"></a>
</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">chen_subset_hummus</span><span class="op">)</span> </span>
<span><span class="va">hummus</span> <span class="op">&lt;-</span> <span class="va">chen_subset_hummus</span></span></code></pre></div>
<div class="section level4">
<h4 id="save-the-mulilayer-in-a-classic-hierarchical-structure">3.1. Save the mulilayer in a classic hierarchical structure<a class="anchor" aria-label="anchor" href="#save-the-mulilayer-in-a-classic-hierarchical-structure"></a>
</h4>
<p>The package used for the random walk with restart exploration
(multixrank) requires currently to save all the network files on disk.
To simplify the organisation of the file, it is possible to save
everything necessary with function <code><a href="../reference/save_multilayer.html">save_multilayer()</a></code>.<br>
It will create a folder (specified through <code>folder_name</code>)
containing all the files necessary to run the multixrank algorithm. The
folder will contain the following subfolders : *
<strong>bipartite</strong> : containing the bipartites files *
<strong>multiplex</strong> : containing the multiplex sub-subfolders *
<strong>multiplex_1</strong> (e.g. TF|peak|RNA) : containing the network
file of each layer of the multiplex * <strong>seed</strong> : that will
contain the seed files (necessary to compute HuMMuS outputs later) *
<strong>config</strong> : that will contain the config files (necessary
to compute HuMMuS outputs later)</p>
<div class="float">
<img src="figures/explore_multilayer.png" alt="hummus object schema"><div class="figcaption">hummus object schema</div>
</div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/save_multilayer.html">save_multilayer</a></span><span class="op">(</span>hummus <span class="op">=</span> <span class="va">hummus</span>,</span>
<span>                folder_name <span class="op">=</span> <span class="st">"chen_multilayer"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in dir.create(folder_name): 'chen_multilayer' already exists</span></span></code></pre>
<pre><code><span><span class="co">## Warning in dir.create(paste0(folder_name, "/", multiplex_folder)):</span></span>
<span><span class="co">## 'chen_multilayer/multiplex' already exists</span></span></code></pre>
<pre><code><span><span class="co">## Warning in dir.create(paste0(folder_name, "/", bipartite_folder)):</span></span>
<span><span class="co">## 'chen_multilayer/bipartite' already exists</span></span></code></pre>
<pre><code><span><span class="co">## Multiplex of  1  networks with 32 features.</span></span>
<span><span class="co">##  Networks names:  TF_network[1] "TF TF_network"</span></span></code></pre>
<pre><code><span><span class="co">## Warning in dir.create(paste0(folder_name, "/", multiplex_folder, "/",</span></span>
<span><span class="co">## multiplex_name)): 'chen_multilayer/multiplex/RNA' already exists</span></span></code></pre>
<pre><code><span><span class="co">## Multiplex of  1  networks with 2000 features.</span></span>
<span><span class="co">##  Networks names:  RNA_GENIE3[1] "RNA RNA_GENIE3"</span></span>
<span><span class="co">## Multiplex of  1  networks with 4639 features.</span></span>
<span><span class="co">##  Networks names:  peak_network_cicero[1] "peaks peak_network_cicero"</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="retrieve-target-genes">3.2. Retrieve target genes<a class="anchor" aria-label="anchor" href="#retrieve-target-genes"></a>
</h4>
<p>With HuMMuS, inference of GRN and target gene of TFs are different
outputs. Indeed, while GRN is computed making TFs compete to regulate
genes (by random walk with restart starting from the genes and going to
the TFs), target genes are computed making genes compete to be regulated
by TFs (by random walk with restart starting from the TFs and going to
the genes).<br> For target genes output, you can specify the list of TFs
(<code>tf_list</code>) to use as seed (if NULL by default, all TFs will
be used as seed). Only the links between the seed TFs and the genes will
be computed. You can also specify the list of genes to use. Only the
score of the genes present in the network and the <code>gene_list</code>
will be returned.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ATF2_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_target_genes.html">define_target_genes</a></span><span class="op">(</span></span>
<span>  <span class="va">hummus</span>,</span>
<span>  tf_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"ATF2"</span><span class="op">)</span>,</span>
<span>  multilayer_f <span class="op">=</span> <span class="st">"chen_multilayer"</span>,</span>
<span>  njobs <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## multiplexes_list :  {'TF': {'TF_network': '00'}, 'RNA': {'RNA_GENIE3': '01'}, 'peaks': {'peak_network_cicero': '01'}}</span></span>
<span><span class="co">## bipartites_list :  {'tf_peak.tsv': {'multiplex_right': 'TF', 'multiplex_left': 'peaks'}, 'atac_rna.tsv': {'multiplex_right': 'peaks', 'multiplex_left': 'RNA'}}</span></span>
<span><span class="co">## folder_multiplexes :  multiplex</span></span>
<span><span class="co">## folder_bipartites :  bipartite</span></span>
<span><span class="co">## gene_list :  None</span></span>
<span><span class="co">## tf_list :  ['ATF2']</span></span>
<span><span class="co">## peak_list :  None</span></span>
<span><span class="co">## config_filename :  target_genes_config.yml</span></span>
<span><span class="co">## config_folder :  config</span></span>
<span><span class="co">## tf_multiplex :  TF</span></span>
<span><span class="co">## peak_multiplex :  peaks</span></span>
<span><span class="co">## rna_multiplex :  RNA</span></span>
<span><span class="co">## update_config :  True</span></span>
<span><span class="co">## save :  False</span></span>
<span><span class="co">## return_df :  True</span></span>
<span><span class="co">## output_f :  None</span></span>
<span><span class="co">## njobs :  1</span></span>
<span><span class="co">## {'TF': {'TF_network': '00'}, 'RNA': {'RNA_GENIE3': '01'}, 'peaks': {'peak_network_cicero': '01'}}</span></span>
<span><span class="co">## bipartites_type has been provided throguh a list, make sure the order matches the one of the 'bipartites' dictionary' keys.</span></span>
<span><span class="co">## {'RNA': {'names': ['RNA_1'], 'graph_type': ['01'], 'layers': ['chen_multilayer/multiplex/RNA/RNA_GENIE3.tsv']}, 'TF': {'names': ['TF_1'], 'graph_type': ['00'], 'layers': ['chen_multilayer/multiplex/TF/TF_network.tsv']}, 'peaks': {'names': ['peaks_1'], 'graph_type': ['01'], 'layers': ['chen_multilayer/multiplex/peaks/peak_network_cicero.tsv']}}</span></span>
<span><span class="co">## ('RNA_1',)</span></span>
<span><span class="co">## RNA_1</span></span>
<span><span class="co">## Opening network from chen_multilayer/multiplex/RNA/RNA_GENIE3.tsv.</span></span>
<span><span class="co">## ('TF_1',)</span></span>
<span><span class="co">## TF_1</span></span>
<span><span class="co">## Opening network from chen_multilayer/multiplex/TF/TF_network.tsv.</span></span>
<span><span class="co">## ('peaks_1',)</span></span>
<span><span class="co">## peaks_1</span></span>
<span><span class="co">## Opening network from chen_multilayer/multiplex/peaks/peak_network_cicero.tsv.</span></span>
<span><span class="co">## {'source': 'peaks', 'target': 'TF', 'graph_type': '00', 'edge_list_df': 'chen_multilayer/bipartite/tf_peak.tsv'}</span></span>
<span><span class="co">## Opening network from chen_multilayer/bipartite/tf_peak.tsv.</span></span>
<span><span class="co">## {'source': 'RNA', 'target': 'peaks', 'graph_type': '00', 'edge_list_df': 'chen_multilayer/bipartite/atac_rna.tsv'}</span></span>
<span><span class="co">## Opening network from chen_multilayer/bipartite/atac_rna.tsv.</span></span>
<span><span class="co">## 1</span></span>
<span><span class="co">## http://127.0.0.1:8787/status</span></span>
<span><span class="co">## Processing seeds... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ATF2_genes</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   index layer path_layer        score   tf     gene</span></span>
<span><span class="co">## 1  1175   RNA      RNA_1 5.291440e-05 ATF2    CDC5L</span></span>
<span><span class="co">## 2   540   RNA      RNA_1 4.570328e-05 ATF2     ATF3</span></span>
<span><span class="co">## 3   591   RNA      RNA_1 4.486208e-05 ATF2    ATP5I</span></span>
<span><span class="co">## 4  1096   RNA      RNA_1 4.485191e-05 ATF2 CCNB1IP1</span></span>
<span><span class="co">## 5  1872   RNA      RNA_1 4.482241e-05 ATF2   DGCR14</span></span>
<span><span class="co">## 6   536   RNA      RNA_1 4.176609e-05 ATF2    ATAT1</span></span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">target_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_target_genes.html">define_target_genes</a></span><span class="op">(</span></span>
<span>  <span class="va">hummus</span>,</span>
<span>  multilayer_f <span class="op">=</span> <span class="st">"chen_multilayer"</span>,</span>
<span>  njobs <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## multiplexes_list :  {'TF': {'TF_network': '00'}, 'RNA': {'RNA_GENIE3': '01'}, 'peaks': {'peak_network_cicero': '01'}}</span></span>
<span><span class="co">## bipartites_list :  {'tf_peak.tsv': {'multiplex_right': 'TF', 'multiplex_left': 'peaks'}, 'atac_rna.tsv': {'multiplex_right': 'peaks', 'multiplex_left': 'RNA'}}</span></span>
<span><span class="co">## folder_multiplexes :  multiplex</span></span>
<span><span class="co">## folder_bipartites :  bipartite</span></span>
<span><span class="co">## gene_list :  None</span></span>
<span><span class="co">## tf_list :  None</span></span>
<span><span class="co">## peak_list :  None</span></span>
<span><span class="co">## config_filename :  target_genes_config.yml</span></span>
<span><span class="co">## config_folder :  config</span></span>
<span><span class="co">## tf_multiplex :  TF</span></span>
<span><span class="co">## peak_multiplex :  peaks</span></span>
<span><span class="co">## rna_multiplex :  RNA</span></span>
<span><span class="co">## update_config :  True</span></span>
<span><span class="co">## save :  False</span></span>
<span><span class="co">## return_df :  True</span></span>
<span><span class="co">## output_f :  None</span></span>
<span><span class="co">## njobs :  1</span></span>
<span><span class="co">## {'TF': {'TF_network': '00'}, 'RNA': {'RNA_GENIE3': '01'}, 'peaks': {'peak_network_cicero': '01'}}</span></span>
<span><span class="co">## bipartites_type has been provided throguh a list, make sure the order matches the one of the 'bipartites' dictionary' keys.</span></span>
<span><span class="co">## {'RNA': {'names': ['RNA_1'], 'graph_type': ['01'], 'layers': ['chen_multilayer/multiplex/RNA/RNA_GENIE3.tsv']}, 'TF': {'names': ['TF_1'], 'graph_type': ['00'], 'layers': ['chen_multilayer/multiplex/TF/TF_network.tsv']}, 'peaks': {'names': ['peaks_1'], 'graph_type': ['01'], 'layers': ['chen_multilayer/multiplex/peaks/peak_network_cicero.tsv']}}</span></span>
<span><span class="co">## ('RNA_1',)</span></span>
<span><span class="co">## RNA_1</span></span>
<span><span class="co">## Opening network from chen_multilayer/multiplex/RNA/RNA_GENIE3.tsv.</span></span>
<span><span class="co">## ('TF_1',)</span></span>
<span><span class="co">## TF_1</span></span>
<span><span class="co">## Opening network from chen_multilayer/multiplex/TF/TF_network.tsv.</span></span>
<span><span class="co">## ('peaks_1',)</span></span>
<span><span class="co">## peaks_1</span></span>
<span><span class="co">## Opening network from chen_multilayer/multiplex/peaks/peak_network_cicero.tsv.</span></span>
<span><span class="co">## {'source': 'peaks', 'target': 'TF', 'graph_type': '00', 'edge_list_df': 'chen_multilayer/bipartite/tf_peak.tsv'}</span></span>
<span><span class="co">## Opening network from chen_multilayer/bipartite/tf_peak.tsv.</span></span>
<span><span class="co">## {'source': 'RNA', 'target': 'peaks', 'graph_type': '00', 'edge_list_df': 'chen_multilayer/bipartite/atac_rna.tsv'}</span></span>
<span><span class="co">## Opening network from chen_multilayer/bipartite/atac_rna.tsv.</span></span>
<span><span class="co">## 31</span></span>
<span><span class="co">## http://127.0.0.1:8787/status</span></span>
<span><span class="co">## Processing seeds... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">target_genes</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   index layer path_layer        score   tf     gene</span></span>
<span><span class="co">## 1  1340   RNA      RNA_1 0.0002318541 CUX1   CHRNB1</span></span>
<span><span class="co">## 2  1175   RNA      RNA_1 0.0002299783 CUX1    CDC5L</span></span>
<span><span class="co">## 3   262   RNA      RNA_1 0.0002217501 CUX1    ALG11</span></span>
<span><span class="co">## 4  1182   RNA      RNA_1 0.0002211187 CUX1    CDCA5</span></span>
<span><span class="co">## 5   196   RNA      RNA_1 0.0002201921 CUX1    AGBL5</span></span>
<span><span class="co">## 6  1172   RNA      RNA_1 0.0001498125 BPTF CDC42SE1</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="define-grn">3.3. Define GRN<a class="anchor" aria-label="anchor" href="#define-grn"></a>
</h4>
<p>The GRN is defined using the multixrank algorithm. It requires to
have the hummuspy python package installed (pip install hummuspy).<br><br> This can be parallelised using the njobs argument. You can also
specify the list of genes and the list of TFs to use.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_grn.html">define_grn</a></span><span class="op">(</span></span>
<span>  <span class="va">hummus</span>,</span>
<span>  multilayer_f <span class="op">=</span> <span class="st">"chen_multilayer"</span>,</span>
<span>  njobs <span class="op">=</span> <span class="fl">5</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grn</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="retrieve-enhancers">3.4. Retrieve enhancers<a class="anchor" aria-label="anchor" href="#retrieve-enhancers"></a>
</h4>
<p><br> You can also specify the list of peaks to use.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">enhancers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_enhancers.html">define_enhancers</a></span><span class="op">(</span></span>
<span>  <span class="va">hummus</span>,</span>
<span>  gene_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"ATF2"</span><span class="op">)</span>,</span>
<span>  multilayer_f <span class="op">=</span> <span class="st">"chen_multilayer"</span>,</span>
<span>  njobs <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## multiplexes_list :  {'TF': {'TF_network': '00'}, 'RNA': {'RNA_GENIE3': '01'}, 'peaks': {'peak_network_cicero': '01'}}</span></span>
<span><span class="co">## bipartites_list :  {'tf_peak.tsv': {'multiplex_right': 'TF', 'multiplex_left': 'peaks'}, 'atac_rna.tsv': {'multiplex_right': 'peaks', 'multiplex_left': 'RNA'}}</span></span>
<span><span class="co">## folder_multiplexes :  multiplex</span></span>
<span><span class="co">## folder_bipartites :  bipartite</span></span>
<span><span class="co">## gene_list :  ['ATF2']</span></span>
<span><span class="co">## tf_list :  None</span></span>
<span><span class="co">## peak_list :  None</span></span>
<span><span class="co">## config_filename :  enhancers_config.yml</span></span>
<span><span class="co">## config_folder :  config</span></span>
<span><span class="co">## tf_multiplex :  TF</span></span>
<span><span class="co">## peak_multiplex :  peaks</span></span>
<span><span class="co">## rna_multiplex :  RNA</span></span>
<span><span class="co">## update_config :  True</span></span>
<span><span class="co">## save :  False</span></span>
<span><span class="co">## return_df :  True</span></span>
<span><span class="co">## output_f :  None</span></span>
<span><span class="co">## njobs :  1</span></span>
<span><span class="co">## {'TF': {'TF_network': '00'}, 'RNA': {'RNA_GENIE3': '01'}, 'peaks': {'peak_network_cicero': '01'}}</span></span>
<span><span class="co">## bipartites_type has been provided throguh a list, make sure the order matches the one of the 'bipartites' dictionary' keys.</span></span>
<span><span class="co">## {'RNA': {'names': ['RNA_1'], 'graph_type': ['01'], 'layers': ['chen_multilayer/multiplex/RNA/RNA_GENIE3.tsv']}, 'TF': {'names': ['TF_1'], 'graph_type': ['00'], 'layers': ['chen_multilayer/multiplex/TF/TF_network.tsv']}, 'peaks': {'names': ['peaks_1'], 'graph_type': ['01'], 'layers': ['chen_multilayer/multiplex/peaks/peak_network_cicero.tsv']}}</span></span>
<span><span class="co">## ('RNA_1',)</span></span>
<span><span class="co">## RNA_1</span></span>
<span><span class="co">## Opening network from chen_multilayer/multiplex/RNA/RNA_GENIE3.tsv.</span></span>
<span><span class="co">## ('TF_1',)</span></span>
<span><span class="co">## TF_1</span></span>
<span><span class="co">## Opening network from chen_multilayer/multiplex/TF/TF_network.tsv.</span></span>
<span><span class="co">## ('peaks_1',)</span></span>
<span><span class="co">## peaks_1</span></span>
<span><span class="co">## Opening network from chen_multilayer/multiplex/peaks/peak_network_cicero.tsv.</span></span>
<span><span class="co">## {'source': 'peaks', 'target': 'TF', 'graph_type': '00', 'edge_list_df': 'chen_multilayer/bipartite/tf_peak.tsv'}</span></span>
<span><span class="co">## Opening network from chen_multilayer/bipartite/tf_peak.tsv.</span></span>
<span><span class="co">## {'source': 'RNA', 'target': 'peaks', 'graph_type': '00', 'edge_list_df': 'chen_multilayer/bipartite/atac_rna.tsv'}</span></span>
<span><span class="co">## Opening network from chen_multilayer/bipartite/atac_rna.tsv.</span></span>
<span><span class="co">## 1</span></span>
<span><span class="co">## http://127.0.0.1:8787/status</span></span>
<span><span class="co">## Processing seeds... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00</span></span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">enhancers</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   index layer path_layer        score gene                     peak</span></span>
<span><span class="co">## 1  3950 peaks    peaks_1 0.0008951819 ATF2   chr6-44387360-44388305</span></span>
<span><span class="co">## 2  3134 peaks    peaks_1 0.0007383304 ATF2 chr3-107522766-107524070</span></span>
<span><span class="co">## 3  4007 peaks    peaks_1 0.0006763254 ATF2 chr7-102125135-102125606</span></span>
<span><span class="co">## 4  4189 peaks    peaks_1 0.0004115710 ATF2   chr7-73738654-73739271</span></span>
<span><span class="co">## 5   676 peaks    peaks_1 0.0003972408 ATF2  chr10-73874242-73875104</span></span>
<span><span class="co">## 6  1699 peaks    peaks_1 0.0003850920 ATF2  chr16-67561885-67563510</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="retrieve-binding-regions">3.5. Retrieve binding regions<a class="anchor" aria-label="anchor" href="#retrieve-binding-regions"></a>
</h4>
<p>For binding regions output, you can specify the list of TFs
(<code>tf_list</code>) to use as seed (if NULL by default, all TFs will
be used as seed). Only the links between the seed TFs and the peaks will
be computed. You can also specify the list of peaks to use. Only the
score of the peaks present in the network and the <code>peak_list</code>
will be returned.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">binding_regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_binding_regions.html">define_binding_regions</a></span><span class="op">(</span></span>
<span>  <span class="va">hummus</span>,</span>
<span>  multilayer_f <span class="op">=</span> <span class="st">"chen_multilayer"</span>,</span>
<span>  njobs <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## multiplexes_list :  {'TF': {'TF_network': '00'}, 'RNA': {'RNA_GENIE3': '01'}, 'peaks': {'peak_network_cicero': '01'}}</span></span>
<span><span class="co">## bipartites_list :  {'tf_peak.tsv': {'multiplex_right': 'TF', 'multiplex_left': 'peaks'}, 'atac_rna.tsv': {'multiplex_right': 'peaks', 'multiplex_left': 'RNA'}}</span></span>
<span><span class="co">## folder_multiplexes :  multiplex</span></span>
<span><span class="co">## folder_bipartites :  bipartite</span></span>
<span><span class="co">## gene_list :  None</span></span>
<span><span class="co">## tf_list :  None</span></span>
<span><span class="co">## peak_list :  None</span></span>
<span><span class="co">## config_filename :  binding_regions_config.yml</span></span>
<span><span class="co">## config_folder :  config</span></span>
<span><span class="co">## tf_multiplex :  TF</span></span>
<span><span class="co">## peak_multiplex :  peaks</span></span>
<span><span class="co">## rna_multiplex :  RNA</span></span>
<span><span class="co">## update_config :  True</span></span>
<span><span class="co">## save :  False</span></span>
<span><span class="co">## return_df :  True</span></span>
<span><span class="co">## output_f :  None</span></span>
<span><span class="co">## njobs :  1</span></span>
<span><span class="co">## {'TF': {'TF_network': '00'}, 'RNA': {'RNA_GENIE3': '01'}, 'peaks': {'peak_network_cicero': '01'}}</span></span>
<span><span class="co">## bipartites_type has been provided throguh a list, make sure the order matches the one of the 'bipartites' dictionary' keys.</span></span>
<span><span class="co">## {'RNA': {'names': ['RNA_1'], 'graph_type': ['01'], 'layers': ['chen_multilayer/multiplex/RNA/RNA_GENIE3.tsv']}, 'TF': {'names': ['TF_1'], 'graph_type': ['00'], 'layers': ['chen_multilayer/multiplex/TF/TF_network.tsv']}, 'peaks': {'names': ['peaks_1'], 'graph_type': ['01'], 'layers': ['chen_multilayer/multiplex/peaks/peak_network_cicero.tsv']}}</span></span>
<span><span class="co">## ('RNA_1',)</span></span>
<span><span class="co">## RNA_1</span></span>
<span><span class="co">## Opening network from chen_multilayer/multiplex/RNA/RNA_GENIE3.tsv.</span></span>
<span><span class="co">## ('TF_1',)</span></span>
<span><span class="co">## TF_1</span></span>
<span><span class="co">## Opening network from chen_multilayer/multiplex/TF/TF_network.tsv.</span></span>
<span><span class="co">## ('peaks_1',)</span></span>
<span><span class="co">## peaks_1</span></span>
<span><span class="co">## Opening network from chen_multilayer/multiplex/peaks/peak_network_cicero.tsv.</span></span>
<span><span class="co">## {'source': 'peaks', 'target': 'TF', 'graph_type': '00', 'edge_list_df': 'chen_multilayer/bipartite/tf_peak.tsv'}</span></span>
<span><span class="co">## Opening network from chen_multilayer/bipartite/tf_peak.tsv.</span></span>
<span><span class="co">## {'source': 'RNA', 'target': 'peaks', 'graph_type': '00', 'edge_list_df': 'chen_multilayer/bipartite/atac_rna.tsv'}</span></span>
<span><span class="co">## Opening network from chen_multilayer/bipartite/atac_rna.tsv.</span></span>
<span><span class="co">## 31</span></span>
<span><span class="co">## http://127.0.0.1:8787/status</span></span>
<span><span class="co">## Processing seeds... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00</span></span></code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">binding_regions</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   index layer path_layer       score   tf                     peak</span></span>
<span><span class="co">## 1   464 peaks    peaks_1 0.001680402 CUX1   chr1-65002512-65003322</span></span>
<span><span class="co">## 2  4617 peaks    peaks_1 0.001675393 CUX1   chrX-48971714-48972653</span></span>
<span><span class="co">## 3   468 peaks    peaks_1 0.001674121 CUX1   chr1-65419692-65420979</span></span>
<span><span class="co">## 4  4615 peaks    peaks_1 0.001559648 CUX1   chrX-48918888-48919598</span></span>
<span><span class="co">## 5  4307 peaks    peaks_1 0.001502478 CUX1   chr8-24955892-24956818</span></span>
<span><span class="co">## 6  2655 peaks    peaks_1 0.001502093 CUX1 chr2-201642365-201643651</span></span></code></pre>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://research.pasteur.fr/en/member/remi-trimbour/" class="external-link">Rémi Trimbour</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
